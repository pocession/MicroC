)
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1, "-", region2))
knitr::opts_chunk$set(echo = TRUE)
# Load functions.
devtools::document()
devtools::load_all()
library(edgeR)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(org.Hs.eg.db)
library(GenomicRanges)
library(GenomicFeatures)
library(AnnotationDbi)
inputDir <- here::here("./Results/processing")
outputDir <- here::here("./Results/DIR")
reticulate::repl_python()
hicfiles <- list.files(path = inputDir, pattern = "_map_extracted\\.csv$", full.names = TRUE)
posfiles <- list.files(path = inputDir, pattern = "_map_PosIndex\\.txt$", full.names = TRUE)
## Healthy donors
df_healthy <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/healthy.csv")
)
## Stimulation
df_bg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44112_A_bg_43615_mc6contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bg.csv")
)
df_lps <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44114_C_lps_43617_mc8contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/lps.csv")
)
df_bcg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcg.csv")
)
df_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/ldhi.csv")
)
df_bcgldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi.csv")
)
## DIR across different stimulation conditions
## Xiaolin exp
df_bcgldhi_bcg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi_bcg.csv")
)
df_bcgldhi_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi_ldhi.csv")
)
df_bcg_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcg_ldhi.csv")
)
## Me and Winsen
df_bg_lps <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44112_A_bg_43615_mc6contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44114_C_lps_43617_mc8contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bg_lps.csv")
)
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list[[treat]] <- annotateDIR(
input = input,
output = output
)
}
## DIR across stimulations
annoted_df_list2 <- list()
for (treat in c("bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list2[[treat]] <- annotateDIR(
input = input,
output = output
)
}
knitr::opts_chunk$set(echo = TRUE)
# Load functions.
devtools::document()
devtools::load_all()
library(edgeR)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(org.Hs.eg.db)
library(GenomicRanges)
library(GenomicFeatures)
library(AnnotationDbi)
inputDir <- here::here("./Results/processing")
outputDir <- here::here("./Results/DIR")
reticulate::repl_python()
hicfiles <- list.files(path = inputDir, pattern = "_map_extracted\\.csv$", full.names = TRUE)
posfiles <- list.files(path = inputDir, pattern = "_map_PosIndex\\.txt$", full.names = TRUE)
## Healthy donors
df_healthy <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/healthy.csv")
)
## Stimulation
df_bg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44112_A_bg_43615_mc6contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bg.csv")
)
df_lps <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44114_C_lps_43617_mc8contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/lps.csv")
)
df_bcg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcg.csv")
)
df_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/ldhi.csv")
)
df_bcgldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi.csv")
)
## DIR across different stimulation conditions
## Xiaolin exp
df_bcgldhi_bcg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi_bcg.csv")
)
df_bcgldhi_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi_ldhi.csv")
)
df_bcg_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcg_ldhi.csv")
)
## Me and Winsen
df_bg_lps <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44112_A_bg_43615_mc6contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44114_C_lps_43617_mc8contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bg_lps.csv")
)
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list[[treat]] <- annotateDIR(
input = input,
output = output
)
}
## looks like only a small fraction are individual-specific
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1, "-", region2))
write.csv(df_blacklist, here::here("./Results/DIR/annotated_blacklist.csv"))
filtered_annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
filtered_annoted_df_list[[treat]] <- annoted_df_list[[treat]] |>
dplyr::mutate(ixid = paste0(region1, "-", region2)) |>
dplyr::filter(!ixid %in% df_blacklist$ixid)
write.csv(filtered_annoted_df_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_", treat, ".csv")))
}
DIR_df <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
DIR_df[[treat]] <- annoted_df_list[[treat]] |>
dplyr::filter(PValue < 0.05)
write.csv(DIR_df[[treat]],
here::here(paste0("./Results/DIR/annotated_DIR_", treat, ".csv")))
}
# IL1b: chr2:112,829,751-112,836,779
# IL37: chr2:112,911,165-112,918,882
# The data is diagonal symmetric, there we just need to check one gene in each region
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
filtered_annotated_il1bil37_df_list <- list()
## filtered out by black list does not chane the result
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
filtered_annotated_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream) |>
dplyr::filter((region2 - resolution/2) > il37_upstream & (region2 + resolution/2) < il37_downstream)
write.csv( filtered_annotated_il1bil37_df_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
}
knitr::opts_chunk$set(echo = TRUE)
# Load functions.
devtools::document()
devtools::load_all()
filtered_annotated_il1bil37_df_list <- as.list()
filtered_annotated_il1bil37_df_list <- list()
## Arrange the dataframe to bed format
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
filtered_annotated_il1bil37_df_list[[treat]] <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
}
View(filtered_annotated_il1bil37_df_list)
filtered_annotated_il1bil37_df_list <- list()
## Arrange the dataframe to bed format
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
filtered_annotated_il1bil37_df_list[[treat]] <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")), row.names = FALSE)
}
filtered_annotated_il1bil37_df_list <- list()
## Arrange the dataframe to bed format
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
filtered_annotated_il1bil37_df_list[[treat]] <- df
}
remove(df)
View(filtered_annotated_il1bil37_df_list)
df <- filtered_annotated_il1bil37_df_list[[1]]
View(df)
final_df <- df[1:3,]
View(final_df)
final_df <- df[,1:3]
View(final_df)
final_df$treat <- treat
View(final_df)
View(df)
final_df <- cbind(final_df, df[,4])
View(final_df)
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, df[["logFC"]])
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.delim(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", header=FALSE)
}
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.csv(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", header=FALSE)
}
View(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.csv(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE)
}
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE)
}
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE, row.names = FALSE)
}
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "+"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "+"
filtered_annotated_il1bil37_bed_list[[treat]] <- df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = " ", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "+"
filtered_annotated_il1bil37_bed_list[[treat]] <- final_df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = " ", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "*"
filtered_annotated_il1bil37_bed_list[[treat]] <- final_df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = " ", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "+"
filtered_annotated_il1bil37_bed_list[[treat]] <- final_df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = " ", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
filtered_annotated_il1bil37_bed_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi",
"bcgldhi_bcg", "bcgldhi_ldhi", "bcg_ldhi", "bg_lps")) {
df <- read.csv(
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
df <- df[,2:ncol(df)]
final_df <- df[,1:3]
final_df$treat <- treat
final_df <- cbind(final_df, data.frame(logFC = df[["logFC"]]))
final_df$strand <- "+"
filtered_annotated_il1bil37_bed_list[[treat]] <- final_df
write.table(filtered_annotated_il1bil37_bed_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".bed")), sep = "\t", col.names = FALSE, row.names = FALSE, quote = FALSE)
}
remove(df)
