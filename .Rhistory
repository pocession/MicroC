mapped_genes1 <- AnnotationDbi::select(txdb,
keys = annotated_df1$tx_name,
keytype = "TXNAME",
columns = c("GENEID"))
# Map gene IDs to gene symbols
mapped_symbols1 <- AnnotationDbi::select(org.Hs.eg.db,
keys = mapped_genes1$GENEID,
columns = "SYMBOL",
keytype = "ENTREZID")
# Check colnames -------------------------------------------------------------\
essential_col <- c("chr", "region1", "region2")
for (i in 1:length(essential_col)) {
if (!essential_col[i] %in% colnames(df)) {
message("Please make sure you have the following column: ", essential_col[i])
return (0)
}
}
remove(essential_col, i)
## Filter out non-standard chr
wanted <- paste0("chr", seq(1:23))
wanted <- c(wanted, "chrX", "chrY")
df <- df |>
dplyr::filter(chr %in% wanted) |>
dplyr::mutate(region1 = as.numeric(region1),
region2 = as.numeric(region2)) |>
dplyr::mutate(ix_id = paste0(chr, "_", region1, "_", region2))
# Annotate the region1 and region2 seperately --------------------------------
## For creating GRange objects
## The ix_id column is used as the identity column
df1 <- df |>
dplyr::select(chr, region1, ix_id) |>
dplyr::mutate(start = region1,
end = region1+1)
df2 <- df |>
dplyr::select(chr, region2, ix_id) |>
dplyr::mutate(start = region2,
end = region2+1)
# Create GRange objects ------------------------------------------------------
gr1 <- GRanges(
seqnames = df1$chr,
ranges = IRanges(start = df1$start, end = df1$end),
ix_id = df1$ix_id
)
gr2 <- GRanges(
seqnames = df2$chr,
ranges = IRanges(start = df2$start, end = df2$end),
ix_id = df2$ix_id
)
# Finding overlap ------------------------------------------------------------
features <- transcripts(txdb)
# Select the id of closet genes ----------------------------------------------
## nearest from peak start
ps.idx1 <- follow(gr1, features)
ps.idx2 <- follow(gr2, features)
## nearest from peak end
pe.idx1 <- precede(gr1, features)
pe.idx2 <- precede(gr2, features)
## check if any peak not matched to the nearest gene
na.idx1 <- is.na(ps.idx1) & is.na(pe.idx1)
na.idx2 <- is.na(ps.idx2) & is.na(pe.idx2)
## Remove na
if (sum(na.idx1) > 0) { ## suggested by Thomas Schwarzl
ps.idx1 <- ps.idx1[!na.idx1]
pe.idx1 <- pe.idx1[!na.idx1]
gr1 <- gr1[!na.idx1]
}
if (sum(na.idx2) > 0) { ## suggested by Thomas Schwarzl
ps.idx2 <- ps.idx2[!na.idx2]
pe.idx2 <- pe.idx2[!na.idx2]
gr2 <- gr2[!na.idx2]
}
# Generate the final data frame ----------------------------------------------
## Identify the closet gene information
features_df1 <- data.frame(txStart1 = start(features[ps.idx1]),
txEnd1 = end(features[pe.idx1]),
txStrand1 = strand(features[ps.idx1]),
tx_id1 = features[ps.idx1]$tx_id,
tx_name1 = features[ps.idx1]$tx_name)
features_df2 <- data.frame(txStart2 = start(features[ps.idx2]),
txEnd2 = end(features[pe.idx2]),
txStrand2 = strand(features[ps.idx2]),
tx_id2 = features[ps.idx2]$tx_id,
tx_name2 = features[ps.idx2]$tx_name)
features_df1 <- features_df1 |>
dplyr::mutate(distanceToTSS1 = ifelse(txStrand1 == "+", txEnd1 - txStart1, txStart1 - txEnd1))
features_df2 <- features_df2 |>
dplyr::mutate(distanceToTSS2 = ifelse(txStrand2 == "+", txEnd2 - txStart2, txStart2 - txEnd2))
gr_df1 <- as.data.frame(gr1)
annotated_df1 <- cbind(gr_df1, features_df1)
annotated_df1 <- annotated_df1[,6:ncol(annotated_df1)]
gr_df2 <- as.data.frame(gr2)
annotated_df2 <- cbind(gr_df2, features_df2)
annotated_df2 <- annotated_df2[,6:ncol(annotated_df2)]
## map to the gene ids
mapped_genes1 <- AnnotationDbi::select(txdb,
keys = annotated_df1$tx_name,
keytype = "TXNAME",
columns = c("GENEID"))
# Map gene IDs to gene symbols
mapped_symbols1 <- AnnotationDbi::select(org.Hs.eg.db,
keys = mapped_genes1$GENEID,
columns = "SYMBOL",
keytype = "ENTREZID")
mapped_genes2 <- AnnotationDbi::select(txdb,
keys = annotated_df2$tx_name,
keytype = "TXNAME",
columns = c("GENEID"))
# Map gene IDs to gene symbols
mapped_symbols2 <- AnnotationDbi::select(org.Hs.eg.db,
keys = mapped_genes2$GENEID,
columns = "SYMBOL",
keytype = "ENTREZID")
annotated_df1 <- cbind(annotated_df1, mapped_genes1, mapped_symbols1)
annotated_df1 <- annotated_df1 |>
dplyr::mutate(gene_id1 = GENEID,
symbol_1 = SYMBOL) |>
dplyr::select(-c(TXNAME, GENEID, SYMBOL, ENTREZID))
# Load functions.
devtools::document()
devtools::load_all()
treat <- "healthy"
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annotated_df <- annotateDIR(
input = input,
output = output
)
View(annotated_df)
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
treat <- "healthy"
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list[[treat]] <- annotateDIR(
input = input,
output = output
)
}
# Load functions.
devtools::document()
devtools::load_all()
library(edgeR)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(org.Hs.eg.db)
library(GenomicRanges)
library(GenomicFeatures)
library(AnnotationDbi)
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
treat <- "healthy"
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
df <- annotateDIR(
input = input,
output = output
)
}
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
df <- annotateDIR(
input = input,
output = output
)
}
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list[[treat]] <- annotateDIR(
input = input,
output = output
)
}
df_blacklist <- annotated_df_list[["healthy"]]
df_blacklist <- annoted_df_list[["healthy"]]
View(df_blacklist)
## looks like only a small fraction are individual-specific
df_blacklist <- annoted_df_list[["healthy"]]
dplyr::filter(PValue < 0.1)
## looks like only a small fraction are individual-specific
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1)
View(annoted_df_list)
View(df_blacklist)
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1 + "-" + region2))
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1, "-", region2))
## looks like only a small fraction are individual-specific
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1, "-", region2))
filtered_annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_df_list[[treat]] <- annoted_df_list[[treat]] |>
dplyr::mutate(ixid = paste0(region1, "-", region2)) |>
dplyr::filter(!ixid %in% df_blacklist$ixid)
write.csv(filtered_annoted_df_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_", treat, ".csv")))
}
View(filtered_annoted_df_list)
knitr::opts_chunk$set(echo = TRUE)
# Load functions.
devtools::document()
devtools::load_all()
library(edgeR)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(org.Hs.eg.db)
library(GenomicRanges)
library(GenomicFeatures)
library(AnnotationDbi)
inputDir <- here::here("./Results/processing")
outputDir <- here::here("./Results/DIR")
reticulate::repl_python()
hicfiles <- list.files(path = inputDir, pattern = "_map_extracted\\.csv$", full.names = TRUE)
posfiles <- list.files(path = inputDir, pattern = "_map_PosIndex\\.txt$", full.names = TRUE)
## Healthy donors
df_healthy <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/healthy.csv")
)
## Stimulation
df_bg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44112_A_bg_43615_mc6contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bg.csv")
)
df_lps <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44114_C_lps_43617_mc8contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/lps.csv")
)
df_bcg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcg.csv")
)
df_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/ldhi.csv")
)
df_bcgldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi.csv")
)
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list[[treat]] <- annotateDIR(
input = input,
output = output
)
}
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1, "-", region2))
write.csv(df_blacklist, here::here("./Results/DIR/annotated_blacklist.csv"))
knitr::opts_chunk$set(echo = TRUE)
# Load functions.
devtools::document()
devtools::load_all()
library(edgeR)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(org.Hs.eg.db)
library(GenomicRanges)
library(GenomicFeatures)
library(AnnotationDbi)
inputDir <- here::here("./Results/processing")
outputDir <- here::here("./Results/DIR")
reticulate::repl_python()
hicfiles <- list.files(path = inputDir, pattern = "_map_extracted\\.csv$", full.names = TRUE)
posfiles <- list.files(path = inputDir, pattern = "_map_PosIndex\\.txt$", full.names = TRUE)
## Healthy donors
df_healthy <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/healthy.csv")
)
## Stimulation
df_bg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44112_A_bg_43615_mc6contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44111_A_ctrl_43614_mc5contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bg.csv")
)
df_lps <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/44114_C_lps_43617_mc8contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/44113_C_ctrl_43616_mc7contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/lps.csv")
)
df_bcg <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCG_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcg.csv")
)
df_ldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/LDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/ldhi.csv")
)
df_bcgldhi <- GetDIRWithNoReplicate(
chr = "chr2",
treat = here::here("./Results/processing/BCGLDHi_contact_map_extracted.csv"),
ctrl = here::here("./Results/processing/DMSO_contact_map_extracted.csv"),
bcv = 0.4,
start_position_index = here::here("./Results/processing/DMSO_contact_map_PosIndex.txt"),
output = here::here("./Results/DIR/bcgldhi.csv")
)
annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
input = here::here(paste0("./Results/DIR/", treat, ".csv"))
output = here::here(paste0("./Results/DIR/annotated_", treat, ".csv"))
annoted_df_list[[treat]] <- annotateDIR(
input = input,
output = output
)
}
## looks like only a small fraction are individual-specific
df_blacklist <- annoted_df_list[["healthy"]] |>
dplyr::filter(PValue < 0.1) |>
dplyr::mutate(ixid = paste0(region1, "-", region2))
write.csv(df_blacklist, here::here("./Results/DIR/annotated_blacklist.csv"))
filtered_annoted_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_df_list[[treat]] <- annoted_df_list[[treat]] |>
dplyr::mutate(ixid = paste0(region1, "-", region2)) |>
dplyr::filter(!ixid %in% df_blacklist$ixid)
write.csv(filtered_annoted_df_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_", treat, ".csv")))
}
View(filtered_annoted_df_list)
View(df_healthy)
il1b_upstream <- 112,829,751 - 5000
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 12836779 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_il1bil37df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream && (region1 + resolution/2) < il1b_downstream)
}
test.df <-  filtered_annoted_df_list[["healthy"]]
View(test.df)
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_il1bil37df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream)
}
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_il1bil37df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream)
}
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream)
}
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annoted_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream)
}
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annotated_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream)
}
View(filtered_annotated_il1bil37_df_list)
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
# IL1b: chr2:112,829,751-112,836,779
# IL37: chr2:112,911,165-112,918,882
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annotated_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream) |>
dplyr::filter((region2 - resolution/2) > il37_upstream & (region2 + resolution/2) < il37_downstream)
}
View(filtered_annotated_il1bil37_df_list)
# IL1b: chr2:112,829,751-112,836,779
# IL37: chr2:112,911,165-112,918,882
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annotated_il1bil37_df_list[[treat]] <- annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream) |>
dplyr::filter((region2 - resolution/2) > il37_upstream & (region2 + resolution/2) < il37_downstream)
}
View(filtered_annotated_il1bil37_df_list)
# IL1b: chr2:112,829,751-112,836,779
# IL37: chr2:112,911,165-112,918,882
# The data is diagonal symmetric, there we just need to check one gene in each region
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annotated_il1bil37_df_list[[treat]] <- annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream) |>
dplyr::filter((region2 - resolution/2) > il37_upstream & (region2 + resolution/2) < il37_downstream)
}
View(filtered_annotated_il1bil37_df_list)
# IL1b: chr2:112,829,751-112,836,779
# IL37: chr2:112,911,165-112,918,882
# The data is diagonal symmetric, there we just need to check one gene in each region
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
filtered_annotated_il1bil37_df_list <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annotated_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream) |>
dplyr::filter((region2 - resolution/2) > il37_upstream & (region2 + resolution/2) < il37_downstream)
}
View(filtered_annoted_df_list)
View(filtered_annotated_il1bil37_df_list)
# IL1b: chr2:112,829,751-112,836,779
# IL37: chr2:112,911,165-112,918,882
# The data is diagonal symmetric, there we just need to check one gene in each region
resolution <- 5000
il1b_upstream <- 112829751 - 5000
il1b_downstream <- 112836779 + 5000
il37_upstream <- 112911165 - 5000
il37_downstream <- 112918882 + 5000
filtered_annotated_il1bil37_df_list <- list()
## filtered out by black list does not chane the result
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
filtered_annotated_il1bil37_df_list[[treat]] <- filtered_annoted_df_list[[treat]] |>
dplyr::filter((region1 - resolution/2) > il1b_upstream & (region1 + resolution/2) < il1b_downstream) |>
dplyr::filter((region2 - resolution/2) > il37_upstream & (region2 + resolution/2) < il37_downstream)
write.csv( filtered_annotated_il1bil37_df_list[[treat]],
here::here(paste0("./Results/DIR/filtered_annotated_il1bil37_", treat, ".csv")))
}
View(filtered_annotated_il1bil37_df_list)
View(filtered_annoted_df_list)
View(annoted_df_list)
DIR_df <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
DIR_df[[treat]] <- annoted_df_list[[treat]] |>
dplyr::filter(PValue < 0.05)
}
View(DIR_df)
View(DIR_df)
DIR_df <- list()
for (treat in c("healthy", "bg", "lps", "bcg", "ldhi", "bcgldhi")) {
DIR_df[[treat]] <- annoted_df_list[[treat]] |>
dplyr::filter(PValue < 0.05)
write.csv(DIR_df[[treat]],
here::here(paste0("./Results/DIR/annotated_DIR_", treat, ".csv")))
}
